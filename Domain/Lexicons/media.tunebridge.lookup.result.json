{
  "lexicon": 1,
  "id": "media.tunebridge.lookup.result",
  "defs": {
    "main": {
      "type": "record",
      "description": "Result of parsing and looking up media links across supported music streaming providers.",
      "key": "tid",
      "record": {
        "type": "object",
        "required": ["results", "lookedUpAt"],
        "properties": {
          "results": {
            "type": "array",
            "description": "Collection of lookup results from each provider that returned a match.",
            "items": {
              "type": "ref",
              "ref": "#providerResult"
            },
            "minLength": 0,
            "maxLength": 10
          },
          "inputLinks": {
            "type": "array",
            "description": "The original media links used for the initial lookup.",
            "items": {
              "type": "string",
              "format": "uri",
              "maxLength": 2000
            },
            "maxLength": 20
          },
          "lookedUpAt": {
            "type": "string",
            "format": "datetime",
            "description": "ISO 8601 timestamp of when this lookup was performed."
          }
        }
      }
    },
    "providerResult": {
      "type": "object",
      "description": "Music metadata from a specific provider's API query.",
      "required": ["provider", "artist", "title", "url", "marketRegion"],
      "properties": {
        "provider": {
          "type": "string",
          "enum": ["appleMusic", "spotify", "tidal"],
          "description": "The streaming platform provider."
        },
        "artist": {
          "type": "string",
          "description": "Primary artist name for the track or album artist.",
          "maxLength": 500
        },
        "title": {
          "type": "string",
          "description": "Official title of the track or album as listed in the provider's catalog.",
          "maxLength": 500
        },
        "externalId": {
          "type": "string",
          "description": "ISRC (for tracks) or UPC (for albums) identifier for cross-platform matching.",
          "maxLength": 50
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Direct web link to the track or album on the provider's platform.",
          "maxLength": 2000
        },
        "artUrl": {
          "type": "string",
          "format": "uri",
          "description": "URL to the cover artwork image.",
          "maxLength": 2000
        },
        "marketRegion": {
          "type": "string",
          "description": "ISO 3166-1 alpha-2 country code for the market/storefront.",
          "maxLength": 2,
          "default": "us"
        },
        "isAlbum": {
          "type": "boolean",
          "description": "True for albums/EPs, false for individual tracks."
        }
      }
    }
  }
}
